class VamtamPosts extends elementorModules.frontend.handlers.Base{onInit(){elementorModules.frontend.handlers.Base.prototype.onInit.apply(this,arguments),this.bindEvents(),this.loadMoreMasonryFix(),this.checkApplySafariFix()}checkApplySafariFix(){const _this=this;jQuery(window).on("load",()=>{jQuery("html").hasClass("safari")&&setTimeout(()=>{_this.onWindowResize()},10)})}recalculateMasonry(){this.elements=this.getDefaultElements(),this.onWindowResize()}checkDiscardDuplicates(){const $el=this.$element,$postsContainer=$el.find(".elementor-posts-container"),$posts=$postsContainer.find(".elementor-post:visible"),$stickyPosts=jQuery(".vamtam-blog-featured-post .elementor-post:visible"),postIDs=[],stickyPostsIDs=[];let removedPosts=0;if($posts.length){if(jQuery.each($posts,(index,post)=>{const postID=parseInt($posts[index].classList[2].match(/\d+/)[0]);postID&&!isNaN(postID)&&(-1===postIDs.indexOf(postID)?postIDs.push(postID):(jQuery(post).remove(),removedPosts++))}),$stickyPosts.length){jQuery.each($stickyPosts,index=>{const stickyPostID=parseInt($stickyPosts[index].classList[2].match(/\d+/)[0]);stickyPostID&&!isNaN(stickyPostID)&&-1===stickyPostsIDs.indexOf(stickyPostID)&&stickyPostsIDs.push(stickyPostID)});const $filteredPosts=$postsContainer.find(".elementor-post:visible");jQuery.each($filteredPosts,(index,post)=>{const postID=parseInt($filteredPosts[index].classList[2].match(/\d+/)[0]);postID&&!isNaN(postID)&&-1!==stickyPostsIDs.indexOf(postID)&&(jQuery(post).remove(),removedPosts++)})}return removedPosts}}loadMoreMasonryFix(){const paginationType=this.getElementSettings().pagination_type;if("load_more_on_click"!==paginationType&&"load_more_infinite_scroll"!==paginationType)return;var $el=this.$element,$postsContainer=$el.find(".elementor-posts-container"),$loadMoreBtn=$el.find(".elementor-button"),$loadMoreAnchor=$el.find(".e-load-more-anchor"),loadMorePaginationEnd="e-load-more-pagination-end",postsCountBeforeLastAjax=null,postsCountAfterLastAjax=null,observer=null,_this=this;const handleInfiniteScroll=()=>{this.isEdit||(observer=elementorModules.utils.Scroll.scrollObserver({callback:event=>{event.isInViewport&&(observer.unobserve($loadMoreAnchor[0]),handleNewAjaxPosts())}})).observe($loadMoreAnchor[0])},onPaginationEnd=()=>{"load_more_on_click"===paginationType?jQuery($loadMoreBtn).off("click",handleNewAjaxPosts):observer.disconnect()},handleNewAjaxPosts=()=>{postsCountBeforeLastAjax=$postsContainer.find(".elementor-post:visible").length;let stoppedChecking=!1;const quickTimer=setInterval(()=>{if(postsCountAfterLastAjax=$postsContainer.find(".elementor-post:visible").length,postsCountBeforeLastAjax!==postsCountAfterLastAjax){const removedPosts=_this.checkDiscardDuplicates();_this.recalculateMasonry(),postsCountBeforeLastAjax=postsCountAfterLastAjax-removedPosts,clearInterval(quickTimer),stoppedChecking=!0,observer&&observer.observe($loadMoreAnchor[0])}$el.hasClass(loadMorePaginationEnd)&&onPaginationEnd()},50);stoppedChecking||setTimeout(()=>{clearInterval(quickTimer)},5e3)};"load_more_on_click"===paginationType?jQuery($loadMoreBtn).on("click",handleNewAjaxPosts):handleInfiniteScroll()}getSkinPrefix(){return"classic_"}bindEvents(){var cid=this.getModelCID();elementorFrontend.addListenerOnce(cid,"resize",this.onWindowResize.bind(this))}getClosureMethodsNames(){return elementorModules.frontend.handlers.Base.prototype.getClosureMethodsNames.apply(this,arguments).concat(["fitImages","onWindowResize","runMasonry"])}getDefaultSettings(){return{classes:{fitHeight:"elementor-fit-height",hasItemRatio:"elementor-has-item-ratio"},selectors:{postsContainer:".elementor-posts-container",post:".elementor-post",postThumbnail:".elementor-post__thumbnail",postThumbnailImage:".elementor-post__thumbnail img"}}}getDefaultElements(){var selectors=this.getSettings("selectors");return{$postsContainer:this.$element.find(selectors.postsContainer),$posts:this.$element.find(selectors.post)}}fitImage($post){var settings=this.getSettings(),$imageParent=$post.find(settings.selectors.postThumbnail),$image,image=$imageParent.find("img")[0];if(image){var imageParentRatio=$imageParent.outerHeight()/$imageParent.outerWidth(),imageRatio=image.naturalHeight/image.naturalWidth;$imageParent.toggleClass(settings.classes.fitHeight,imageRatio<imageParentRatio)}}fitImages(){var $=jQuery,self=this,itemRatio=getComputedStyle(this.$element[0],":after").content,settings=this.getSettings();this.elements.$postsContainer.toggleClass(settings.classes.hasItemRatio,!!itemRatio.match(/\d/)),self.isMasonryEnabled()||this.elements.$posts.each((function(){var $post=$(this),$image=$post.find(settings.selectors.postThumbnailImage);self.fitImage($post),$image.on("load",(function(){self.fitImage($post)}))}))}setColsCountSettings(){var currentDeviceMode=elementorFrontend.getCurrentDeviceMode(),settings=this.getElementSettings(),skinPrefix=this.getSkinPrefix(),colsCount;switch(currentDeviceMode){case"mobile":colsCount=settings[skinPrefix+"columns_mobile"];break;case"tablet":colsCount=settings[skinPrefix+"columns_tablet"];break;default:colsCount=settings[skinPrefix+"columns"]}this.setSettings("colsCount",colsCount)}isMasonryEnabled(){return!!this.getElementSettings(this.getSkinPrefix()+"masonry")}runMasonry(){var elements=this.elements;elements.$posts.css({marginTop:"",transitionDuration:""}),this.setColsCountSettings();var colsCount=this.getSettings("colsCount"),hasMasonry=this.isMasonryEnabled()&&colsCount>=2;if(elements.$postsContainer.toggleClass("elementor-posts-masonry",hasMasonry),hasMasonry){var verticalSpaceBetween=this.getElementSettings(this.getSkinPrefix()+"row_gap.size"),masonry;""===this.getSkinPrefix()&&""===verticalSpaceBetween&&(verticalSpaceBetween=this.getElementSettings(this.getSkinPrefix()+"item_gap.size")),new elementorModules.utils.Masonry({container:elements.$postsContainer,items:elements.$posts.filter(":visible"),columnsCount:this.getSettings("colsCount"),verticalSpaceBetween:verticalSpaceBetween}).run()}else elements.$postsContainer.height("")}onWindowResize(){this.fitImages(),this.runMasonry()}}jQuery(window).on("elementor/frontend/init",()=>{if(elementorFrontend.elementsHandler&&elementorFrontend.elementsHandler.attachHandler)elementorFrontend.elementsHandler.attachHandler("posts",VamtamPosts,"classic");else{const addHandler=$element=>{elementorFrontend.elementsHandler.addHandler(VamtamPosts,{$element:$element})};elementorFrontend.hooks.addAction("frontend/element_ready/posts.default",addHandler,100)}});